(()=>{sys41.system.boot.set('\n    system41 presents <a class="rainbow-text">open99</a> version 0.4 (official.dev)');let e,t=sys41.system.boot.set("booting on "+Date()+"<br />in "+window.navigator.userAgent+"<br />");if("https://open99.ga"===location.href?t.classList.add("hidden"):sys41.system.boot.set('WARNING: you are running this on a custom, development, or staging server.<br />\n        please be aware this is not an official release of open99. <a href="//docs.open99.ga/hosting/server" target="_blank"><b>learn more</b></a>',{icon:"warning"}),location.href.includes("#")){let t=location.href.indexOf("#");e=location.href.slice(0,t),sys41.system.boot.set("Server: "+e)}else if(location.href.includes("?")){let t=location.href.indexOf("?");e=location.href.slice(0,t),sys41.system.boot.set("Server: "+e)}location.port?sys41.system.boot.set("Port number: "+location.port):sys41.system.boot.set("Port: none"),"https:"===location.protocol?sys41.system.boot.set("Protocol: secure (HTTPS)",{icon:"success"}):sys41.system.boot.set("Protocol: "+location.protocol+'<br / >Watch out! The protocol you are using is insecure and therefore many open99 features will fail to work. <a href="//docs.open99.ga/hosting/insecure-protocol">learn more</a>',{icon:"warning"}),location.hash?location.hash.indexOf("access_token=")>-1&&location.hash.indexOf("refresh_token=")>-1&&location.hash.indexOf("token_type")>-1&&location.hash.indexOf("expires_in")>-1?sys41.system.boot.set("Hash: none (signin)"):sys41.system.boot.set("Hash: "+decodeURI(location.hash)):sys41.system.boot.set("Hash: none");let s,o=[];for(let e=0;e<navigator.plugins.length;e++)o.push(navigator.plugins[e].name);sys41.system.boot.set("System plugins: "+o.join(", "),{color:"lime"}),document.getElementById("stylelink").setAttribute("href","system/styles/themes/98.css"),document.body.addEventListener("contextmenu",(function(e){e.preventDefault()})),localforage.getItem("_profile").then((function(e){s=!!e})),s?localforage.iterate((function(e,t,s){sys41.fs.set(t,e),sys41.system.boot.set("Extracted "+t,{color:"yellow"})})).then((function(){sys41.system.boot.set("File iteration has completed. localforage files are now on sys41.fs")})).catch((function(e){sys41.system.boot.set(e,{icon:"error",blink:!0}),console.error(e)})):new JSZip.external.Promise((function(e,t){JSZipUtils.getBinaryContent("./system/fs/rootfs.zip",(function(s,o){s?(t(s),sys41.system.boot.set(s,{error:!0})):e(o)}))})).then(JSZip.loadAsync).then((function(e){e.forEach((function(e,t){sys41.system.boot.set("Extracting "+e)}))})),html2canvas(document.body).then(e=>{sys41.fs.set("/b:/script.png",e.toDataURL())}),sys41.fs.set("/b:/script.html",sys41.dom.boot.innerHTML),s?sys41.system.boot.finish():sys41.fs.set("_profile",{accountType:"local",firstTime:!0}),sys41.settings.strtmnu||(sys41.settings.strtmnu=[{name:"Documents",id:"documents",icon:"",exec:"alert('not ready yet! :P well at least this worked')"},{name:"Programs",id:"programs",icon:"",items:[{name:"Test",icon:"",exec:"alert('hey, this worked! hooray')"}],itemsSmall:!0}]);let n=document.createElement("div");n.id="dsktop",n.style.visibility="hidden",document.body.appendChild(n);let i=document.createElement("div");i.id="tskbar",n.appendChild(i);let a=document.createElement("button");a.innerHTML='\n  <img src="/system/assets/98/system/img/open99-16.png" /><b>Start</b>\n  ',i.appendChild(a);let r=document.createElement("div");sys41.settings.strtmnu.forEach(e=>{r.innerHTML+=`\n    <div class="item" data-item-id="${e.id}" onclick="${e.exec}">\n      <img src="${e.icon}" />\n      <p>${e.name}</p>\n      <div class="hidden itemsSmall">\n        <img src>\n      </div>\n    </div>\n    `}),sys41.dom.boot.remove(),n.style.visibility="block"})();